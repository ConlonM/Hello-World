<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>组件基础</title>
<!--     <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js">
		Vue.config.devtools = true;
    </script> -->
    <script src="./vue-2.6.10.js">
		Vue.config.devtools = true;
    </script>
    <link rel="stylesheet" href="css/common.css">
</head>
<body>
    <div class="box" id="app">
        <div class="card">
            <div class="title">
                基本示例
            </div>
            <div class="body">
                    <button-counter>

                    </button-counter>
            </div>
        </div>
        <div class="card">
            <div class="title">
                监听子组件事件
            </div>
            <div class="body"  :style="{ fontSize: fontSize + 'px' }"> 
               <blog-post v-for="post in posts" v-bind:post="post" v-on:set-font-size="setFontsize">

               </blog-post>
            </div>
        </div>
        <div class="card">
            <div class="title">
                在组件上使用 v-model
            </div>
            <div class="body">
                <p>父级的值：{{userName}}</p>
                <custom-iput v-model="userName">  

                </custom-iput>
            </div>
        </div>

        <div class="card">
            <div class="title">
                    通过插槽分发内容
            </div>
            <div class="body">
                 <alert-box>
                     一些事情发生错误了！！SW
                 </alert-box>
            </div>
        </div>

        <div class="card">
            <div class="title">
                自己实验的表单数据
            </div>
            <div class="body">
                <custom-iput2 v-for="post in posts" v-model="post.title">

                </custom-iput2>
            </div>
        </div>

        <div class="card">
            <div class="title">
                单项数据流
            </div>
            <div class="body">
                <input type="text" v-model="propDate">
                <data-convert v-bind:date="propDate">

                </data-convert>
            </div>
        </div>
        <div class="card">
            <div class="title">
                prop验证--一一绑定
            </div>
            <div class="body">
                <input type="text" v-model.number="propValue">
                <prop-verify  
                v-bind:prop-a="props.propA"
                v-bind:prop-b="props.propB"
                v-bind:prop-c="props.propC"
                v-bind:prop-d="props.propD"
                v-bind:prop-e="props.propE"
                v-bind:prop-f="propValue">

                </prop-verify>
            </div>
        </div>
        <div class="card">
                <div class="title">
                    prop验证--对象绑定
                </div>
                <div class="body">
                    <prop-verify v-bind="props">
    
                    </prop-verify>
                </div>
            </div>
        <div class="card">
            <div class="title">
                进行特性继承
            </div>
            <div class="body">
                    <inherit-attrs 
                    v-model="userName"
                    placeholder="请输入文字"
                    label="姓名："
                    ss="sss"
                    class="xxx"
                    type="text"
                    readonly
                    >

                    </inherit-attrs>
            </div>
        </div>
        <div class="card">
                <div class="title">
                    深入组件-自定义事件
                </div>
                <div class="body">
                    <p>
                            <label for="">是否选中</label>
                            <base-checkbox
                                v-model='ischecked'
                            >
                            </base-checkbox>
                    </p>
                    <p>
                        <label for="">ischecked=</label><input type="checkbox" name="" id="" v-model="ischecked">
                    </p>      
                </div>
        </div>
        <div class="card">
            <div class="title">
                将原生事件绑定到组件
            </div>
            <div class="body">
                <native-input-event v-on:click="nativeOnfocus">

                </native-input-event>
            </div>


        </div>
        <div class="card">
            <div class="title">
                具名插槽
            </div>
            <div class="body">
                <slot-name-com>
                    <template v-slot:header>
                        我是Header插槽的
                    </template>
                   
                        我是main插槽的
   

                    <template v-slot:footer>
                        我是Footer插槽的
                    </template>
                </slot-name-com>
            </div>
        </div>
        <div class="card">
            <div class="title">
                插槽作用域
            </div>
            <div class="body">
               <slot-scope>
                    <template v-slot:slot-a="">
                            {{currentUser.name}}

                        </template>
               </slot-scope>   
              
            </div>
        </div>
        <div class="card">
            <div class="title">
                动态插槽
            </div>
            <div class="body">
                <slot-scope>
                    <template v-slot:[dynamicSlot]="currentUser">
                        {{currentUser}}
                    </template>
                </slot-scope>
            </div>
        </div>
    </div>




    <script>

         //组件基础示例
         Vue.component('button-counter',{
            data:function(){
                return {
                    count:0
                }
            },
            template:'<button v-on:click="count++">点击按键{{count+1}}</button>'
        })
        //监听子组件事件
        Vue.component("blog-post",{
            props:['post'],
            template:'<div class="blog-post"><h1>{{post.title}}</h1><button v-on:click="$emit(\'set-font-size\',18)">设置字号</button><div v-html="post.content"></div> </div>'
        });
        //在组件上使用  v-model
        Vue.component("custom-iput",{
            props:["value"],
            template:'<div><label>姓名：</label><input v-bind:value="value" v-on:input="$emit(\'input\',$event.target.value)"></input><p>子组件值：{{value}}</p></div>'
        })
         //通过插槽分发内容
        Vue.component("alert-box",{
            props:[],
            template:"<div><strong>Error</strong><slot></slot></div>"
        })
            //在组件上使用  v-model
            Vue.component("custom-iput2",{
            props:["value"],
            template:'<div><label>标题：</label><input v-bind:value="value" v-on:input="$emit(\'input\',$event.target.value)"></input><p>子组件值：{{value}}</p></div>'
        })
        //组件数据初始化
        Vue.component("dataConvert",{
            props:[
                "date"
            ],
            template:`
                    <div>
                        <p>
                            <span>prop值={{date}}</span>
                        </p>
                        <p>
                            <span>{{dateShow}}</span>
                        </p>
                        <p>
                            <span>{{dateComputed}}</span>
                        </p>
                        
                    </div>`,
            data:function(){
                return {
                    dateShow:"组件data初始化="+this.date
                }
            },
            computed:{
                dateComputed:function(){
                    return "组件计算属性="+this.date;
                }
            }
        });
        Vue.component("propVerify",{
            props:{
                propA:Number,
                propB:[String,Number],
                //必填项
                propC:{
                    type:String,
                    required:true
                },
                //带有默认值string
                propD:{
                    type:Number,
                    default:100
                },
                //带有默认值的对象
                propE:{
                    type:Object,
                    default:function(){
                        return {
                            id:"01",
                            name:"嚣张"
                        };
                    }
                },
                //自定义验证函数
                propF:{
                    type:Number,
                    validator:function(value){
                        return value>0;
                    }
                }
            },
            template:`
                    <div>
                    <p>
                    Numeber类型： {{propA}}
                    </p>
                    <p>
                        多类型：{{propB}}
                    </p>
                    <p>
                            required的string:{{propC}}
                    </p>
                    <p>
                        默认值的Number：{{propD}}
                    </p>
                    <p>
                        带有默认值的对象:{{propE}}
                    </p>
                    <p>
                        自定义校验方法：{{propF}}
                    </p>
                </div>           
            `
        });
       Vue.component("inheritAttrs",{
            inheritAttrs:true,
            props:['label','value'],
            template:`    
                    <label >
                        {{label}}
                        <input type="text" 
                           
                            v-bind:value="value"
                            v-on:input="$emit('input',$event.target.value)"
                        >
                        <p>
                          $attrs的值：{{$attrs}}
                       </p>
                    </label>
                    `
       });
       Vue.component("base-checkbox",{
           model:{
               prop:'checkedCustom',
               event:'change'
           },
           props:{
               checkedCustom:Boolean
           },
           template:`
           <input type="checkbox"
           v-bind:checked="checkedCustom"
           v-on:change="$emit('change',$event.target.checked)"           
           >           
           `
        });
        Vue.component("native-input-event",{
            inheritAttrs:false,
            props:["label","value"],
            data:function(){
                 return {
                     nativeName:0
                 }
            },
            computed:  {
                inputListeners:function(){
                    var that = this;
                    return Object.assign({},
                    this.$listeners,
                    {
                        input:function(event){
                            that.$emit("input",event.target.value);
                        },
                        click:function(event){
                            that.nativeName+=1;
                        }
                    })
                }
            },
            template:`    
                    <label for="">
                        {{label}}
                        <input type="text" 
                            v-bind="$attrs"
                            v-bind:value="value"
                            v-on="inputListeners"
                        >
                        <p>inputListeners的值={{$listeners}}</p>
                        <p>inputListeners的值={{nativeName}}</p>
                    </label>`
        });
        //修饰符。sync的例子
        Vue.component("text-document",{
            
        });

        //具名插槽的例子
        Vue.component("slot-name-com",{
            template:`     
    <div class="container">
         <div class="header">
            <slot name="header"></slot>
         </div>
         <div class="main">
            <slot></slot>
         </div>
         <div class="footer">
            <slot name="footer">
                
            </slot>
         </div>
     </div>`
        
        });
        
        Vue.component("slot-scope",{
            data:function(){
               return {
                currentUser:{
                    name:"张三丰",
                    info:"家住黄河边，手握荒芜山，拳打南少林，脚踢武当山。"
                }
               }
            },
            template:`    <div>

<div>
   <span>
                我是插槽A:
    </span>
            <br>
    <slot name="slot-a" v-bind="currentUser">
{{currentUser.name}}
    </slot>
</div>

<div>
        <span>
                     我是插槽B:
         </span>
                 <br>
         <slot name="slot-b">
                {{currentUser.info}}
         </slot>
     </div>
</div>`
        });


        var app = new Vue({
            el:"#app",
           data:{
            posts:[{title:"雅迪电车疑似倒闭？",content:""},{title:"雅迪电车总经理被情人举报？",content:""}],
            fontSize:21,
            userName:"无名氏",
            propDate:"2019-05-03",
            props:{
                propA:100,
                propB:"多类型",                
                propC:"",
                propD:101,

               /* propE:{
                            id:"02",
                            name:"龙芯"
                },*/
                
                propF:1
            },
            propValue:100,
            ischecked:true,
            currentUser:{
                name:'解构插槽',
                info:'结构查操操操哦擦'
            },
            dynamicSlot:"slot-a"
           },
           methods:{
               //传入子组件的事件值
               setFontsize:function(e){
                    this.fontSize = e;
                    console.log("进入setFontsize:"+e);
               },
               nativeOnfocus:function(e)
               {
                   this.userName+="1";  
                   console.log("进入nativeOnfocus:"+e);
               }
           }
        });

    </script>
</body>
</html>